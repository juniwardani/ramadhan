<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Petugas Ramadan 1446 H - Rumah Tahfidz Saijaan</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Amiri&display=swap">
    <link rel="stylesheet" href="styles.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<style>
	* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Amiri', serif;
    background-color: #f8f9fa;
    color: #2c3e50;
}

.container {
    max-width: 100%;
    margin: 0 auto;
    padding: 10px;
}

header {
    text-align: center;
    margin-bottom: 20px;
    padding: 10px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

h1 {
    font-size: 1.5rem;
    margin-bottom: 10px;
    color: #1a237e;
}

h2 {
    font-size: 1.2rem;
    margin-bottom: 5px;
    color: #283593;
}

.table-container {
    width: 100%;
    overflow-x: auto;
    position: relative;
    isolation: isolate;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.sticky-header {
    display: flex;
    position: sticky;
    top: 0;
    z-index: 1000;
    white-space: nowrap;
    background: inherit;
    isolation: isolate;
}

.header-cell {
    padding: 12px 8px;
    flex: 1;
    min-width: 120px;
    text-align: center;
    font-weight: bold;
    background: #1a237e;
    color: white;
    border-bottom: 1px solid rgba(255,255,255,0.2);
    position: relative;
}

/* Colored headers for specific columns */
.header-cell:nth-child(2) { background: #D32F2F; }
.header-cell:nth-child(3) { background: #F57C00; }
.header-cell:nth-child(4) { background: #388E3C; }
.header-cell:nth-child(5) { background: #1565C0; }
.header-cell:nth-child(6) { background: #6A1B9A; }

/* Perlebar cell adzan dan sholawat */
.header-cell:nth-child(5),
.header-cell:nth-child(6),
.table-cell:nth-child(5),
.table-cell:nth-child(6) {
    min-width: 200px;
}

/* Sticky Header dan Kolom Pertama */
.header-cell:first-child,
.table-cell:first-child {
    position: sticky;
    left: 0;
    z-index: 1001;
    isolation: isolate;
}

.header-cell:first-child {
    z-index: 1002;
    background: #1a237e !important;
}

.table-cell:first-child {
    z-index: 999;
}

/* Memastikan background color kolom pertama */
.table-row:nth-child(even) .table-cell:first-child {
    background-color: #f5f7ff !important;
}

.table-row:nth-child(odd) .table-cell:first-child {
    background-color: #fff !important;
}

.table-row:hover .table-cell:first-child {
    background-color: #e8eaf6 !important;
}

/* Memastikan background tetap solid saat scroll */
.table-cell:first-child::after {
    content: '';
    position: absolute;
    top: 0;
    right: -2px;
    height: 100%;
    width: 4px;
    background: linear-gradient(to right, rgba(0,0,0,0.05), transparent);
    z-index: 998;
}

.table-body {
    display: flex;
    flex-direction: column;
    position: relative;
    isolation: isolate;
}

.table-row {
    display: flex;
    border-bottom: 1px solid #e3e8f0;
    position: relative;
    isolation: isolate;
}

/* Striped! Rows */
.table-row:nth-child(even) .table-cell:nth-child(2) { background-color: #FFEBEE; }
.table-row:nth-child(even) .table-cell:nth-child(3) { background-color: #FFF3E0; }
.table-row:nth-child(even) .table-cell:nth-child(4) { background-color: #E8F5E9; }
.table-row:nth-child(even) .table-cell:nth-child(5) { background-color: #E3F2FD; }
.table-row:nth-child(even) .table-cell:nth-child(6) { background-color: #F3E5F5; }

.table-row:nth-child(odd) .table-cell:nth-child(2) { background-color: #FFCDD2; }
.table-row:nth-child(odd) .table-cell:nth-child(3) { background-color: #FFE0B2; }
.table-row:nth-child(odd) .table-cell:nth-child(4) { background-color: #C8E6C9; }
.table-row:nth-child(odd) .table-cell:nth-child(5) { background-color: #BBDEFB; }
.table-row:nth-child(odd) .table-cell:nth-child(6) { background-color: #E1BEE7; }

.table-row:nth-child(even) {
    background-color: #f5f7ff;
}

.table-row:nth-child(even) .table-cell:first-child {
    background-color: #f5f7ff;
}

.table-row:nth-child(odd) .table-cell:first-child {
    background-color: #fff;
}

.table-row:hover {
    background-color: #e8eaf6;
}

.table-row:hover .table-cell:first-child {
    background-color: #e8eaf6;
}

.table-cell {
    padding: 12px 8px;
    flex: 1;
    min-width: 120px;
    text-align: center;
    transition: background-color 0.2s ease;
    line-height: 1.4;
    position: relative;
}

.table-cell:first-child {
    font-weight: 500;
    color: #1a237e;
    white-space: normal;
}

.table-cell.sholawat-cell,
.table-cell.adzan-cell {
    white-space: normal;
}

.site-header {
    background: #800000;
    color: white;
    padding: 15px 0;
    text-align: center;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.logo-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 10px;
}

.logo {
    width: 60px;
    height: 60px;
}

.site-title {
    font-size: 2.5rem;
    margin: 0;
    font-weight: bold;
    color: white;
}

.site-subtitle {
    font-size: 1rem;
    margin: 5px 0;
    opacity: 0.9;
}

.site-footer {
    background: #800000;
    color: white;
    padding: 15px 0;
    margin-top: 20px;
    text-align: center;
}

.footer-content {
    max-width: 800px;
    margin: 0 auto;
    padding: 0 20px;
}

.copyright {
    font-size: 0.9rem;
}

.footer-info,
.contact-info,
.contact-item,
.social-links,
.social-link {
    display: none;
}

/* Download button styles */
.download-container {
    display: flex;
    justify-content: center;
    margin: 20px 0;
}

.download-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    background-color: #800000;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Amiri', serif;
    font-size: 1rem;
    transition: background-color 0.3s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.download-btn:hover {
    background-color: #600000;
}

.download-btn:active {
    transform: translateY(1px);
}

.download-icon {
    fill: currentColor;
}

@media (max-width: 768px) {
    .container {
        padding: 5px;
    }
    
    h1 {
        font-size: 1.2rem;
    }
    
    h2 {
        font-size: 1rem;
    }
    
    .header-cell, .table-cell {
        padding: 8px 6px;
        min-width: 120px;
        font-size: 0.9rem;
    }

    /* Perlebar cell adzan dan sholawat untuk mobile */
    .header-cell:nth-child(5),
    .header-cell:nth-child(6),
    .table-cell:nth-child(5),
    .table-cell:nth-child(6) {
        min-width: 200px;  /* Konsisten dengan desktop */
    }

    /* Perbaikan sticky untuk mobile */
    .header-cell:first-child,
    .table-cell:first-child {
        position: sticky;
        left: 0;
        z-index: 1001;
        isolation: isolate;
        transform: translateZ(0);
        will-change: transform;
    }

    .header-cell:first-child {
        z-index: 1002;
        background: #1a237e !important;
    }

    .table-cell:first-child {
        z-index: 999;
    }

    /* Memastikan background tetap solid di layar kecil */
    .table-row:nth-child(even) .table-cell:first-child {
        background-color: #f5f7ff !important;
    }

    .table-row:nth-child(odd) .table-cell:first-child {
        background-color: #fff !important;
    }

    .table-row:hover .table-cell:first-child {
        background-color: #e8eaf6 !important;
    }

    /* Shadow effect untuk layar kecil */
    .table-cell:first-child::after {
        content: '';
        position: absolute;
        top: 0;
        right: -2px;
        height: 100%;
        width: 4px;
        background: linear-gradient(to right, rgba(0,0,0,0.05), transparent);
        z-index: 998;
    }

    .sticky-header {
        z-index: 1000;
    }

    .table-container {
        -webkit-overflow-scrolling: touch; /* Untuk scroll yang lebih smooth di iOS */
    }

    .site-title {
        font-size: 2rem;
    }
    
    .site-subtitle {
        font-size: 0.9rem;
    }
    
    .logo {
        width: 50px;
        height: 50px;
    }
    
    .contact-info {
        flex-direction: column;
        gap: 10px;
    }
    
    .download-btn {
        padding: 10px 20px;
        font-size: 0.9rem;
    }
    
    .download-icon {
        width: 20px;
        height: 20px;
    }
}

/* Custom scrollbar styling */
.table-container::-webkit-scrollbar {
    height: 8px;
}

.table-container::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.table-container::-webkit-scrollbar-thumb {
    background: #3f51b5;
    border-radius: 4px;
}

.table-container::-webkit-scrollbar-thumb:hover {
    background: #1a237e;
}

@media print {
    .table-container {
        overflow: visible !important;
        box-shadow: none !important;
    }
    
    .sticky-header, .header-cell {
        position: static !important;
    }
    
    .table-cell:first-child {
        position: static !important;
    }
}

/* Tambahkan style untuk kode pembimbing */
.code-H { color: #E91E63; font-weight: bold; }
.code-HS { color: #2196F3; font-weight: bold; }
.code-T { color: #4CAF50; font-weight: bold; }
.code-S { color: #FF9800; font-weight: bold; }
.code-SY { color: #9C27B0; font-weight: bold; }
.code-R { color: #795548; font-weight: bold; }
.code-J { color: #607D8B; font-weight: bold; }
.code-A { color: #FF5722; font-weight: bold; }
.code-I { color: #009688; font-weight: bold; }
.code-U { color: #3F51B5; font-weight: bold; }

/* Style untuk hasil download */
.download-code-H { color: #E91E63; font-weight: bold; }
.download-code-HS { color: #2196F3; font-weight: bold; }
.download-code-T { color: #4CAF50; font-weight: bold; }
.download-code-S { color: #FF9800; font-weight: bold; }
.download-code-SY { color: #9C27B0; font-weight: bold; }
.download-code-R { color: #795548; font-weight: bold; }
.download-code-J { color: #607D8B; font-weight: bold; }
.download-code-A { color: #FF5722; font-weight: bold; }
.download-code-I { color: #009688; font-weight: bold; }
.download-code-U { color: #3F51B5; font-weight: bold; }

/* Highlight untuk baris tanggal hari ini */
.table-row.today {
    background: rgba(255, 243, 224, 0.7) !important;
    border: 2px solid #FF9800;
    position: relative;
}

.table-row.today .table-cell {
    background-color: rgba(255, 243, 224, 0.7) !important;
}

.table-row.today .table-cell:first-child,
.table-row.today .table-cell:nth-child(2),
.table-row.today .table-cell:nth-child(3),
.table-row.today .table-cell:nth-child(4),
.table-row.today .table-cell:nth-child(5),
.table-row.today .table-cell:nth-child(6) {
    background-color: rgba(255, 243, 224, 0.9) !important;
    font-weight: bold;
    color: #E65100;
}

</style>

<body>
    <!-- Site Header -->
    <header class="site-header">
        
                <h1 class="site-title">Rumah Tahfidz Saijaan</h1>
            </div>
        </div>
    </header>

    <div class="container">
        <header>
            <h1>Jadwal Petugas Ramadan 1446 H<br>Rumah Tahfidz Saijaan</h1>
        </header>

        <div class="table-container">
            <div class="sticky-header">
                <div class="header-cell">Tanggal</div>
                <div class="header-cell">Imam</div>
                <div class="header-cell">Juz</div>
                <div class="header-cell">Imam Witir</div>
                <div class="header-cell">Sholawat</div>
                <div class="header-cell">Adzan</div>
            </div>
            
            <div class="table-body" id="tableBody"></div>
        </div>
        
        <div class="download-container">
            <button id="downloadBtn" class="download-btn">
                <svg class="download-icon" viewBox="0 0 24 24" width="24" height="24">
                    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                </svg>
                Download Jadwal (JPG)
            </button>
        </div>
    </div>

    <!-- Simplified Site Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="copyright">
                <p>&copy; 2024 Rumah Tahfidz Saijaan. Hak Cipta Dilindungi.</p>
            </div>
        </div>
    </footer>

    <script>
    	const jadwalPetugas = [
    { tanggal: "05 Maret 2025", imam: "Muhammad Rifat Azizi Rahman", juz: "Juz 1 Awal", imamWitir: "Muhammad Fauzi", 
      sholawat: ["M. Rama Fakhrullah (H)", "M. Nasyid Haikal (HS)"], 
      adzan: ["M. Akbar Safaruddin (T)", "Gusti Hanif Al Khalifi (S)"] },
    { tanggal: "06 Maret 2025", imam: "Muhammad Aditya", juz: "Juz 1 Akhir", imamWitir: "Muhammad Shidqii Fadhillah", 
      sholawat: ["Ahmad Faiq Fahmi (R)", "M. Rizky Zaidan (J)"], 
      adzan: ["M. Rafka Anwar (U)", "M. Adli Maulana (R)"] },
    { tanggal: "07 Maret 2025", imam: "Rafi Syahdilla", juz: "Juz 2 Awal", imamWitir: "Muhammad Shidqii Fadhillah", 
      sholawat: ["M. Hafidz Ramadhanis (S)", "M. Adam Al Fatih (R)"], 
      adzan: ["Ahmad Faiq Fahmi (R)", "Ariansyah (SY)"] },
    { tanggal: "08 Maret 2025", imam: "Muhammad Aufa Rahman", juz: "Juz 2 Akhir", imamWitir: "Muhammad Rizqi Yazid", 
      sholawat: ["M. Fatih Mubarok (T)", "M. Arkan Ramadhan (A)"], 
      adzan: ["Faiz Hazmi Anwari (SY)", "M. Nasyid Haikal (HS)"] },
    { tanggal: "09 Maret 2025", imam: "Muhammad Shidqii Fadhillah", juz: "Juz 3 Awal", imamWitir: "Muhammad Rizqi Yazid", 
      sholawat: ["Alfarizky Meilan Pratama (T)", "M. Hanan Al Faiz (HS)"], 
      adzan: ["M. Zainul Sulthan (H)", "M. Aylaby Fathory (A)"] },
    { tanggal: "10 Maret 2025", imam: "Muhammad Fauzi", juz: "Juz 3 Akhir", imamWitir: "Muhammad Nabil Riyadi", 
      sholawat: ["M. Khairil Akmal (I)", "M. Yusuf Madani (J)"], 
      adzan: ["M. Rama Fakhrullah (H)", "M. Haikal Bagus (T)"] },
    { tanggal: "11 Maret 2025", imam: "Rafi Syahdilla", juz: "Juz 4 Awal", imamWitir: "Muhammad Nabil Riyadi", 
      sholawat: ["Faeza Hasan Azhari (H)", "M. Haikal Bagus (T)"], 
      adzan: ["Farhan Rasyad Farandy (H)", "M. Alif Yahsan (A)"] },
    { tanggal: "12 Maret 2025", imam: "Rafli Daffa Santoso", juz: "Juz 4 Akhir", imamWitir: "Ahmad Dirjat Abdala", 
      sholawat: ["M. Habibi Darussalam (H)", "M. Aylaby Fathory (A)"], 
      adzan: ["M. Yusuf Madani (J)", "Alfarizky Meilan Pratama (T)"] },
    { tanggal: "13 Maret 2025", imam: "Rafli Daffa Santoso", juz: "Juz 5 Awal", imamWitir: "Ahmad Dirjat Abdala", 
      sholawat: ["M. Restu Firdaus (I)", "M. Rizky Zaidan (J)"], 
      adzan: ["Muhammad Ulil Albab (A)", "M. Hanan Al Faiz (HS)"] },
    { tanggal: "14 Maret 2025", imam: "Muhammad Shidqii Fadhillah", juz: "Juz 5 Akhir", imamWitir: "Muhammad Fauzi", 
      sholawat: ["Muhammad Ulil Albab (A)", "Faiz Hazmi Anwari (SY)"], 
      adzan: ["Ahmad Galih Prihandowo (SY)", "Faeza Hasan Azhari (H)"] },
    { tanggal: "15 Maret 2025", imam: "Muhammad Aufa Rahman", juz: "Juz 6 Awal", imamWitir: "Muhammad Fauzi", 
      sholawat: ["M. Akbar Safaruddin (T)", "M. Adli Maulana (R)"], 
      adzan: ["M. Naufal Faeza (U)", "M. Rafka Anwar (U)"] },
    { tanggal: "16 Maret 2025", imam: "Muhammad Shidqii Fadhillah", juz: "Juz 6 Akhir", imamWitir: "Muhammad Rafi Syahdilla", 
      sholawat: ["M. Zainul Sulthan (H)", "M. Naufal Faeza (U)"], 
      adzan: ["M. Nahru Rohman (I)", "M. Khairil Akmal (I)"] },
    { tanggal: "17 Maret 2025", imam: "Muhammad Aufa Rahman", juz: "Juz 7 Awal", imamWitir: "Muhammad Rafi Syahdilla", 
      sholawat: ["M. Alif Yahsan (A)", "M. Faiq Jayyidan (H)"], 
      adzan: ["M. Hafidz Ramadhanis (S)", "M. Rama Fakhrullah (H)"] },
    { tanggal: "18 Maret 2025", imam: "Muhammad Shidqii Fadhillah", juz: "Juz 7 Akhir", imamWitir: "Muhammad Rizqi Yazid", 
      sholawat: ["M. Multazam (A)", "Gusti Hanif Al Khalifi (S)"], 
      adzan: ["M. Arkan Ramadhan (A)", "Ariansyah (SY)"] },
    { tanggal: "19 Maret 2025", imam: "Muhammad Hariri", juz: "Juz 29 Awal", imamWitir: "Muhammad Rizqi Yazid", 
      sholawat: ["Farhan Rasyad Farandy (H)", "Ahmad Galih Prihandowo (SY)"], 
      adzan: ["Rakha Nurhafidzan (J)", "M. Habibi Darussalam (H)"] },
    { tanggal: "20 Maret 2025", imam: "Muhammad Hariri", juz: "Juz 29 Akhir", imamWitir: "Muhammad Nabil Riyadi", 
      sholawat: ["M. Nahru Rohman (I)", "M. Restu Firdaus (I)"], 
      adzan: ["M. Multazam (A)", "M. Rizky Zaidan (J)"] },
    { tanggal: "21 Maret 2025", imam: "Muhammad Fauzi", juz: "Juz 30 Awal", imamWitir: "Muhammad Shidqii Fadhillah", 
      sholawat: ["Rakha Nurhafidzan (J)", "M. Fatih Mubarok (T)"], 
      adzan: ["M. Faiq Jayyidan (H)", "M. Alif Yahsan (A)"] },
    { tanggal: "22 Maret 2025", imam: "Muhammad Shidqii Fadhillah", juz: "Juz 30 Akhir", imamWitir: "Muhammad Fauzi", 
      sholawat: ["Ariansyah (SY)", "M. Habibi Darussalam (H)"], 
      adzan: ["M. Adam Al Fatih (R)", "Ahmad Faiq Fahmi (R)"] }
];

const tableBody = document.getElementById('tableBody');

// Ubah fungsi untuk menambahkan warna pada kode pembimbing
function formatPembimbingCode(text) {
    return text.replace(/\(([A-Z]+)\)/g, (match, code) => {
        return `<span class="code-${code}">(${code})</span>`;
    });
}

function formatPembimbingCodeDownload(text) {
    return text.replace(/\(([A-Z]+)\)/g, (match, code) => {
        return `<span class="download-code-${code}">(${code})</span>`;
    });
}

function formatDate(date) {
    const options = { day: '2-digit', month: 'long', year: 'numeric' };
    return date.toLocaleDateString('id-ID', options);
}

jadwalPetugas.forEach(row => {
    const rowElement = document.createElement('div');
    rowElement.className = 'table-row';
    
    // Cek apakah tanggal ini adalah hari ini
    const today = formatDate(new Date());
    if (row.tanggal === today) {
        rowElement.classList.add('today');
    }
    
    // Create cells for each piece of data
    const tanggalCell = document.createElement('div');
    tanggalCell.className = 'table-cell';
    tanggalCell.textContent = row.tanggal;
    
    const imamCell = document.createElement('div');
    imamCell.className = 'table-cell';
    imamCell.textContent = row.imam;
    
    const juzCell = document.createElement('div');
    juzCell.className = 'table-cell';
    juzCell.textContent = row.juz;
    
    const imamWitirCell = document.createElement('div');
    imamWitirCell.className = 'table-cell';
    imamWitirCell.textContent = row.imamWitir;
    
    const sholawatCell = document.createElement('div');
    sholawatCell.className = 'table-cell sholawat-cell';
    sholawatCell.innerHTML = row.sholawat.map(s => formatPembimbingCode(s)).join('<br>');
    
    const adzanCell = document.createElement('div');
    adzanCell.className = 'table-cell adzan-cell';
    adzanCell.innerHTML = row.adzan.map(a => formatPembimbingCode(a)).join('<br>');
    
    // Add all cells to the row
    rowElement.appendChild(tanggalCell);
    rowElement.appendChild(imamCell);
    rowElement.appendChild(juzCell);
    rowElement.appendChild(imamWitirCell);
    rowElement.appendChild(sholawatCell);
    rowElement.appendChild(adzanCell);
    
    // Add row to table body
    tableBody.appendChild(rowElement);
});

document.getElementById('downloadBtn').addEventListener('click', async () => {
    try {
        const btn = document.getElementById('downloadBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = 'Memproses...';
        btn.disabled = true;

        const tempContainer = document.createElement('div');
        tempContainer.style.width = '1500px';  // Perlebar container
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.style.background = '#ffffff';
        tempContainer.style.padding = '40px';
        document.body.appendChild(tempContainer);

        const title = document.createElement('div');
        title.style.textAlign = 'center';
        title.style.marginBottom = '30px';
        title.style.fontFamily = 'Amiri, serif';
        title.innerHTML = `
            <h1 style="color: #1a237e; font-size: 32px; margin-bottom: 15px;">Jadwal Petugas Ramadan 1446 H</h1>
            <h2 style="color: #1a237e; font-size: 24px;">Rumah Tahfidz Saijaan</h2>
        `;
        tempContainer.appendChild(title);

        // Buat table element daripada div untuk struktur yang lebih baik
        const table = document.createElement('table');
        table.style.width = '100%';
        table.style.borderCollapse = 'collapse';
        table.style.fontFamily = 'Amiri, serif';
        table.style.fontSize = '16px';
        table.style.boxShadow = '0 0 10px rgba(0,0,0,0.1)';
        table.style.borderRadius = '8px';
        table.style.overflow = 'hidden';

        // Header row
        const thead = document.createElement('thead');
        thead.innerHTML = `
            <tr style="background: #1a237e;">
                <th style="width: 12%; padding: 15px 10px; color: white; text-align: center; background: #1a237e;">Tanggal</th>
                <th style="width: 18%; padding: 15px 10px; color: white; text-align: center; background: #D32F2F;">Imam</th>
                <th style="width: 12%; padding: 15px 10px; color: white; text-align: center; background: #F57C00;">Juz</th>
                <th style="width: 18%; padding: 15px 10px; color: white; text-align: center; background: #388E3C;">Imam Witir</th>
                <th style="width: 20%; padding: 15px 10px; color: white; text-align: center; background: #1565C0;">Sholawat</th>
                <th style="width: 20%; padding: 15px 10px; color: white; text-align: center; background: #6A1B9A;">Adzan</th>
            </tr>
        `;
        table.appendChild(thead);

        // Table body
        const tbody = document.createElement('tbody');
        jadwalPetugas.forEach((row, index) => {
            const colors = index % 2 === 0 ? 
                ['#fff', '#FFCDD2', '#FFE0B2', '#C8E6C9', '#BBDEFB', '#E1BEE7'] :
                ['#f5f7ff', '#FFEBEE', '#FFF3E0', '#E8F5E9', '#E3F2FD', '#F3E5F5'];

            const tr = document.createElement('tr');
            tr.style.borderBottom = '1px solid #e3e8f0';

            const cellStyle = (color) => `
                padding: 12px 10px;
                text-align: center;
                background: ${color};
                vertical-align: middle;
                line-height: 1.5;
                font-size: 15px;
            `;

            tr.innerHTML = `
                <td style="${cellStyle(colors[0])}">${row.tanggal}</td>
                <td style="${cellStyle(colors[1])}">${row.imam}</td>
                <td style="${cellStyle(colors[2])}">${row.juz}</td>
                <td style="${cellStyle(colors[3])}">${row.imamWitir}</td>
                <td style="${cellStyle(colors[4])}">${row.sholawat.map(s => formatPembimbingCodeDownload(s)).join('<br>')}</td>
                <td style="${cellStyle(colors[5])}">${row.adzan.map(a => formatPembimbingCodeDownload(a)).join('<br>')}</td>
            `;
            tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        tempContainer.appendChild(table);

        const canvas = await html2canvas(tempContainer, {
            scale: 2,
            backgroundColor: '#ffffff',
            logging: false,
            useCORS: true,
            windowWidth: 1500,
            width: 1500
        });

        const image = canvas.toDataURL('image/jpeg', 1.0);
        const link = document.createElement('a');
        link.download = 'Jadwal-Petugas-Ramadan-1446H.jpg';
        link.href = image;
        link.click();

        document.body.removeChild(tempContainer);
        btn.innerHTML = originalText;
        btn.disabled = false;
    } catch (error) {
        console.error('Error generating image:', error);
        btn.innerHTML = originalText;
        btn.disabled = false;
    }
});
            </script>
</body>
</html>
